!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class e{constructor(t,r,n){if("number"==typeof t)this._data=new Uint8Array(t),this._view=new DataView(this._data.buffer);else if(t instanceof Uint8Array)this._data=t,this._view=new DataView(this._data.buffer,t.byteOffset,t.byteLength);else if("string"==typeof t){const e=r||"utf8";this._data=function(e,t="utf8"){if("utf8"===t){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}if("ascii"===t){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t}if("hex"===t){const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t}throw new Error(`Unsupported encoding: ${t}`)}(t,e),this._view=new DataView(this._data.buffer)}else if(t instanceof ArrayBuffer){const e=r||0,i=void 0!==n?n:t.byteLength-e;this._data=new Uint8Array(t,e,i),this._view=new DataView(t,e,i)}else t instanceof e?(this._data=t._data,this._view=t._view):Array.isArray(t)?(this._data=new Uint8Array(t),this._view=new DataView(this._data.buffer)):void 0===t?(this._data=new Uint8Array(0),this._view=new DataView(this._data.buffer)):(this._data=new Uint8Array(t),this._view=new DataView(this._data.buffer))}readUInt8(e){return this._view.getUint8(e)}readUInt16BE(e){return this._view.getUint16(e,!1)}readUInt16LE(e){return this._view.getUint16(e,!0)}readUInt32BE(e){return this._view.getUint32(e,!1)}readUInt32LE(e){return this._view.getUint32(e,!0)}readUIntBE(e,t){let r=0;for(let n=0;n<t;n++)r=(r<<8)+this._view.getUint8(e+n);return r}writeUInt8(e,t){this._view.setUint8(t,e)}writeUInt16BE(e,t){this._view.setUint16(t,e,!1)}writeUInt32BE(e,t){this._view.setUint32(t,e,!1)}writeUInt32LE(e,t){this._view.setUint32(t,e,!0)}writeUIntBE(e,t,r){for(let n=r-1;n>=0;n--)this._view.setUint8(t+n,255&e),e>>=8}toString(e="utf8"){return function(e,t="utf8"){if("utf8"===t){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(r){return t}}else{if("ascii"===t){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(255&e[r]);return t}if("hex"===t){let t="";for(let r=0;r<e.length;r++){const n=e[r].toString(16);t+=1===n.length?"0"+n:n}return t}}throw new Error(`Unsupported encoding: ${t}`)}(this._data,e)}slice(t,r){const n=this._data.slice(t,r);return new e(n)}get length(){return this._data.length}get buffer(){return this._data.buffer}toUint8Array(){return new Uint8Array(this._data)}toArrayBuffer(){const e=this.buffer;if("undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)throw new Error("Cannot convert SharedArrayBuffer to ArrayBuffer");return e.slice(this._data.byteOffset,this._data.byteOffset+this._data.byteLength)}static alloc(t){return new e(t)}static from(t,r){if(t instanceof e)return t;if(t instanceof Uint8Array)return new e(t);if(t instanceof ArrayBuffer)return new e(t);if("string"==typeof t)return new e(t,r);if(Array.isArray(t))return new e(new Uint8Array(t));throw new Error("Unsupported data type")}static concat(t){let r=0;for(let e=0;e<t.length;e++)r+=t[e].length;const n=new Uint8Array(r);let i=0;for(let s=0;s<t.length;s++){const r=t[s];r instanceof e?(n.set(r._data,i),i+=r.length):r instanceof Uint8Array&&(n.set(r,i),i+=r.length)}return new e(n)}}function t(t){let r;if(r=t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):t instanceof e?t.toUint8Array():new Uint8Array(t),r.length>=3&&255===r[0]&&216===r[1]&&255===r[2])return{mime:"image/jpeg"};if(r.length>=8&&137===r[0]&&80===r[1]&&78===r[2]&&71===r[3]&&13===r[4]&&10===r[5]&&26===r[6]&&10===r[7])return{mime:"image/png"};if(r.length>=4&&71===r[0]&&73===r[1]&&70===r[2]&&56===r[3])return{mime:"image/gif"};if(r.length>=12&&82===r[0]&&73===r[1]&&70===r[2]&&70===r[3]&&87===r[8]&&69===r[9]&&66===r[10]&&80===r[11])return{mime:"image/webp"};throw new Error("Unsupported image type")}function r(r){let n;n=r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):r instanceof e?r.toUint8Array():new Uint8Array(r);const i=t(n);if("image/jpeg"===i.mime)return function(e){let t=2;for(;t<e.length;){if(255!==e[t]){t++;continue}const r=e[t+1];if(r>=192&&r<=195){const r=e[t+5]<<8|e[t+6];return{width:e[t+7]<<8|e[t+8],height:r}}t+=216===r||217===r||r>=208&&r<=215?2:2+(e[t+2]<<8|e[t+3])}throw new Error("Could not determine JPEG dimensions")}(n);if("image/png"===i.mime)return function(e){if(e.length<24)throw new Error("Invalid PNG file");return{width:e[16]<<24|e[17]<<16|e[18]<<8|e[19],height:e[20]<<24|e[21]<<16|e[22]<<8|e[23]}}(n);throw new Error(`Unsupported image type: ${i.mime}`)}const n=2,i=3,s=5;async function a(t){if(t instanceof e)return t;if(t instanceof Uint8Array)return new e(t);if(t instanceof ArrayBuffer)return new e(t);if(t instanceof File||t instanceof Blob){const r=await t.arrayBuffer();return new e(r)}throw new Error("Unsupported data type. Expected ArrayBuffer, Uint8Array, File, Blob, or BrowserBuffer.")}class o{constructor(e){if(this.buffer=null,this.streamInfo=null,this.blocks=[],this.padding=null,this.vorbisComment=null,this.vendorString="",this.tags=[],this.pictures=[],this.picturesSpecs=[],this.picturesDatas=[],this.framesOffset=0,e instanceof File||e instanceof Blob)throw new Error("File and Blob objects must be loaded asynchronously. Use Metaflac.fromFile() or Metaflac.fromBlob() instead.");this.flac=e,this.init()}static async fromFile(e){const t=await a(e);return new o(t)}static async fromBlob(e){const t=await a(e);return new o(t)}static fromArrayBuffer(e){return new o(e)}static fromUint8Array(e){return new o(e)}init(){if(this.flac instanceof e)this.buffer=this.flac;else if(this.flac instanceof Uint8Array)this.buffer=new e(this.flac);else{if(!(this.flac instanceof ArrayBuffer))throw new Error("Metaflac(flac) flac must be ArrayBuffer, Uint8Array, or BrowserBuffer.");this.buffer=new e(this.flac)}let t=0;if("fLaC"!==this.buffer.slice(0,t+=4).toString("ascii"))throw new Error("The file does not appear to be a FLAC file.");let r=0,a=!1;for(;!a;){r=this.buffer.readUInt8(t++),a=r>128,r%=128;const e=this.buffer.readUIntBE(t,3);t+=3,0===r&&(this.streamInfo=this.buffer.slice(t,t+e)),1===r&&(this.padding=this.buffer.slice(t,t+e)),4===r&&(this.vorbisComment=this.buffer.slice(t,t+e),this.parseVorbisComment()),6===r&&(this.pictures.push(this.buffer.slice(t,t+e)),this.parsePictureBlock()),[n,i,s].includes(r)&&this.blocks.push([r,this.buffer.slice(t,t+e)]),t+=e}this.framesOffset=t}parseVorbisComment(){if(!this.vorbisComment)return;const e=this.vorbisComment.readUInt32LE(0);this.vendorString=this.vorbisComment.slice(4,e+4).toString("utf8"),this.vorbisComment.readUInt32LE(4+e);const t=this.vorbisComment.slice(4+e+4);for(let r=0;r<t.length;){const e=t.readUInt32LE(r);r+=4;const n=t.slice(r,r+e).toString("utf8");r+=e,this.tags.push(n)}}parsePictureBlock(){this.pictures.forEach(e=>{let t=0;const r=e.readUInt32BE(t);t+=4;const n=e.readUInt32BE(t);t+=4;const i=e.slice(t,t+n).toString("ascii");t+=n;const s=e.readUInt32BE(t);t+=4;const a=e.slice(t,t+s).toString("utf8");t+=s;const o=e.readUInt32BE(t);t+=4;const c=e.readUInt32BE(t);t+=4;const l=e.readUInt32BE(t);t+=4;const f=e.readUInt32BE(t);t+=4;const u=e.readUInt32BE(t);t+=4,this.picturesDatas.push(e.slice(t,t+u)),this.picturesSpecs.push(this.buildSpecification({type:r,mime:i,description:a,width:o,height:c,depth:l,colors:f}))})}getPicturesSpecs(){return this.picturesSpecs}getMd5sum(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.slice(18,34).toString("hex")}getMinBlocksize(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.readUInt16BE(0)}getMaxBlocksize(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.readUInt16BE(2)}getMinFramesize(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.readUIntBE(4,3)}getMaxFramesize(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.readUIntBE(7,3)}getSampleRate(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return this.streamInfo.readUIntBE(10,3)>>4}getChannels(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return(15&this.streamInfo.readUIntBE(10,3))>>1}getBps(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return(496&this.streamInfo.readUIntBE(12,2))>>4}getTotalSamples(){if(!this.streamInfo)throw new Error("StreamInfo is not available");return 68719476735&this.streamInfo.readUIntBE(13,5)}getVendorTag(){return this.vendorString}getTag(e){return this.tags.filter(t=>t.split("=")[0]===e).join("\n")}removeTag(e){this.tags=this.tags.filter(t=>t.split("=")[0]!==e)}removeFirstTag(e){const t=this.tags.findIndex(t=>t.split("=")[0]===e);-1!==t&&this.tags.splice(t,1)}removeAllTags(){this.tags=[]}setTag(e){if(-1===e.indexOf("="))throw new Error(`malformed vorbis comment field "${e}", field contains no '=' character`);this.tags.push(e)}importTagsFromString(e){const t=e.split("\n").filter(e=>e.trim());t.forEach(e=>{if(-1===e.indexOf("="))throw new Error(`malformed vorbis comment "${e}", contains no '=' character`)}),this.tags=this.tags.concat(t)}exportTagsToString(){return this.tags.join("\n")}importPictureFromBuffer(n){let i;if(n instanceof e)i=n;else if(n instanceof Uint8Array)i=new e(n);else{if(!(n instanceof ArrayBuffer))throw new Error("Picture must be Uint8Array, ArrayBuffer, or BrowserBuffer");i=new e(n)}const s=i.toUint8Array(),{mime:a}=t(s);if("image/jpeg"!==a&&"image/png"!==a)throw new Error(`only support image/jpeg and image/png picture temporarily, current import ${a}`);const o=r(s),c=this.buildSpecification({mime:a,width:o.width,height:o.height});this.pictures.push(this.buildPictureBlock(i,c)),this.picturesSpecs.push(c),this.picturesDatas.push(i)}async importPictureFromFile(e){const t=await e.arrayBuffer();this.importPictureFromBuffer(t)}exportPictureToBlob(e=0){if(this.picturesDatas.length>e){const t=this.picturesDatas[e],r=this.picturesSpecs[e];return new Blob([t.toArrayBuffer()],{type:r.mime})}throw new Error(`Picture index ${e} does not exist`)}exportPictureToArrayBuffer(e=0){if(this.picturesDatas.length>e)return this.picturesDatas[e].toArrayBuffer();throw new Error(`Picture index ${e} does not exist`)}removePicture(e=0){if(!(this.pictures.length>e))throw new Error(`Picture index ${e} does not exist`);this.pictures.splice(e,1),this.picturesSpecs.splice(e,1),this.picturesDatas.splice(e,1)}removeAllPictures(){this.pictures=[],this.picturesSpecs=[],this.picturesDatas=[]}getAllTags(){return this.tags}buildSpecification(e={}){return Object.assign({type:3,mime:"image/jpeg",description:"",width:0,height:0,depth:24,colors:0},e)}buildPictureBlock(t,r){const n=e.alloc(4),i=e.alloc(4),s=e.from(r.mime,"ascii"),a=e.alloc(4),o=e.from(r.description,"utf8"),c=e.alloc(4),l=e.alloc(4),f=e.alloc(4),u=e.alloc(4),h=e.alloc(4);return n.writeUInt32BE(r.type,0),i.writeUInt32BE(r.mime.length,0),a.writeUInt32BE(r.description.length,0),c.writeUInt32BE(r.width,0),l.writeUInt32BE(r.height,0),f.writeUInt32BE(r.depth,0),u.writeUInt32BE(r.colors,0),h.writeUInt32BE(t.length,0),e.concat([n,i,s,a,o,c,l,f,u,h,t])}buildMetadataBlock(t,r,n=!1){const i=e.alloc(4);return n&&(t+=128),i.writeUIntBE(t,0,1),i.writeUIntBE(r.length,1,3),e.concat([i,r])}buildMetadata(){if(!this.streamInfo)throw new Error("StreamInfo is not available");const t=[];t.push(this.buildMetadataBlock(0,this.streamInfo)),this.blocks.forEach(e=>{t.push(this.buildMetadataBlock(...e))}),t.push(this.buildMetadataBlock(4,function(t,r){const n=[],i=e.from(t,"utf8"),s=e.alloc(4);s.writeUInt32LE(i.length,0);const a=e.alloc(4);a.writeUInt32LE(r.length,0),n.push(s,i,a);for(let o=0;o<r.length;o++){const t=r[o],i=e.from(t,"utf8"),s=e.alloc(4);s.writeUInt32LE(i.length,0),n.push(s,i)}return e.concat(n)}(this.vendorString,this.tags))),this.pictures.forEach(e=>{t.push(this.buildMetadataBlock(6,e))});const r=this.padding||e.alloc(4);return t.push(this.buildMetadataBlock(1,r,!0)),t}buildStream(){if(!this.buffer)throw new Error("Buffer is not available");const e=this.buildMetadata();return[this.buffer.slice(0,4),...e,this.buffer.slice(this.framesOffset)]}save(){const t=this.buildStream();return e.concat(t).toArrayBuffer()}saveAsBlob(){const e=this.save();return new Blob([e],{type:"audio/flac"})}saveAsBuffer(){const t=this.buildStream();return e.concat(t)}}window.Metaflac=o;let c=null,l=null,f=[];function u(e,t="info"){const r=document.getElementById("log");if(!r)return;const n=document.createElement("div");n.className=`log-entry log-${t}`,n.textContent=`[${(new Date).toLocaleTimeString()}] ${e}`,r.appendChild(n),r.scrollTop=r.scrollHeight}function h(e,t){const r=document.getElementById("fileStatus");r&&(r.textContent=t,r.className=`status status-${e}`)}function g(){if(!c)return;const e=document.getElementById("tagsList");if(e)try{const t=c.getAllTags();if(0===t.length)return void(e.innerHTML='<p class="empty">暂无标签</p>');e.innerHTML=t.map(e=>{const[t,r]=e.split("=");return`<div class="tag-item"><span class="tag-name">${t}:</span><span class="tag-value">${r}</span></div>`}).join("")}catch(t){u(`获取标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}}function d(){if(!c)return;const e=document.getElementById("picturesList");if(e)try{f.forEach(e=>{URL.revokeObjectURL(e)}),f=[];const t=c.getPicturesSpecs();if(0===t.length)return void(e.innerHTML='<p class="empty">暂无图片</p>');e.innerHTML=t.map((e,t)=>{try{const r=c.exportPictureToBlob(t),n=URL.createObjectURL(r);return f.push(n),`<div class="picture-item">\n            <img src="${n}" alt="图片 ${t+1}" />\n            <div class="picture-info">\n              <span class="picture-index">图片 ${t+1}</span>\n              <span class="picture-type">${e.mime}</span>\n              <span class="picture-size">${e.width}x${e.height}</span>\n            </div>\n          </div>`}catch(r){return`<div class="picture-item">\n            <div class="picture-info">\n              <span class="picture-index">图片 ${t+1}</span>\n              <span class="picture-type">${e.mime}</span>\n              <span class="picture-size">${e.width}x${e.height}</span>\n              <span class="picture-error">加载失败</span>\n            </div>\n          </div>`}}).join("")}catch(t){u(`获取图片信息失败: ${t instanceof Error?t.message:String(t)}`,"error")}}window.flacInstance=c,window.currentFile=l,window.clearLog=function(){const e=document.getElementById("log");e&&(e.innerHTML="")},document.addEventListener("DOMContentLoaded",()=>{u("页面加载完成","info"),u("Metaflac 模块已加载","success"),h("ready","请选择 FLAC 文件");const e=document.getElementById("flacFileInput");e&&e.addEventListener("change",async e=>{const t=e.target,r=t.files?.[0];if(!r)return;l=r,window.currentFile=l;const n=document.getElementById("fileName");n&&(n.textContent=r.name),h("loading","正在加载文件..."),u(`正在加载文件: ${r.name}`,"info");try{c=await o.fromFile(r),window.flacInstance=c,u("文件加载成功","success"),h("ready","文件已加载"),function(){if(!c)return;const e=document.getElementById("fileInfoGrid");if(!e)return;try{const t=[{label:"采样率",value:`${c.getSampleRate()} Hz`},{label:"声道数",value:`${c.getChannels()}`},{label:"位深度",value:`${c.getBps()} bit`},{label:"总采样数",value:`${c.getTotalSamples().toLocaleString()}`},{label:"最小块大小",value:`${c.getMinBlocksize()}`},{label:"最大块大小",value:`${c.getMaxBlocksize()}`},{label:"最小帧大小",value:`${c.getMinFramesize()}`},{label:"最大帧大小",value:`${c.getMaxFramesize()}`},{label:"MD5",value:c.getMd5sum()},{label:"供应商",value:c.getVendorTag()}];e.innerHTML=t.map(e=>`<div class="info-item"><span class="info-label">${e.label}:</span><span class="info-value">${e.value}</span></div>`).join("")}catch(t){u(`获取文件信息失败: ${t instanceof Error?t.message:String(t)}`,"error")}}(),g(),d();const e=document.getElementById("fileInfoSection"),t=document.getElementById("tagsSection"),n=document.getElementById("picturesSection"),i=document.getElementById("saveSection");e&&(e.style.display="block"),t&&(t.style.display="block"),n&&(n.style.display="block"),i&&(i.style.display="block")}catch(i){u(`文件加载失败: ${i instanceof Error?i.message:String(i)}`,"error"),h("error","文件加载失败"),console.error("文件加载错误:",i)}});const t=document.getElementById("pictureFileInput");t&&t.addEventListener("change",async e=>{const t=e.target,r=t.files?.[0];if(r&&c)try{await c.importPictureFromFile(r),u(`图片导入成功: ${r.name}`,"success"),d()}catch(n){u(`图片导入失败: ${n instanceof Error?n.message:String(n)}`,"error"),console.error("图片导入错误:",n)}}),window.addEventListener("beforeunload",()=>{f.forEach(e=>{URL.revokeObjectURL(e)}),f=[]})}),window.testGetMd5sum=function(){if(c)try{u(`MD5: ${c.getMd5sum()}`,"success")}catch(e){u(`获取 MD5 失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetMinBlocksize=function(){if(c)try{u(`最小块大小: ${c.getMinBlocksize()}`,"success")}catch(e){u(`获取最小块大小失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetMaxBlocksize=function(){if(c)try{u(`最大块大小: ${c.getMaxBlocksize()}`,"success")}catch(e){u(`获取最大块大小失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetMinFramesize=function(){if(c)try{u(`最小帧大小: ${c.getMinFramesize()}`,"success")}catch(e){u(`获取最小帧大小失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetMaxFramesize=function(){if(c)try{u(`最大帧大小: ${c.getMaxFramesize()}`,"success")}catch(e){u(`获取最大帧大小失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetSampleRate=function(){if(c)try{u(`采样率: ${c.getSampleRate()} Hz`,"success")}catch(e){u(`获取采样率失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetChannels=function(){if(c)try{u(`声道数: ${c.getChannels()}`,"success")}catch(e){u(`获取声道数失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetBps=function(){if(c)try{u(`位深度: ${c.getBps()} bit`,"success")}catch(e){u(`获取位深度失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetTotalSamples=function(){if(c)try{u(`总采样数: ${c.getTotalSamples().toLocaleString()}`,"success")}catch(e){u(`获取总采样数失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetVendorTag=function(){if(c)try{u(`供应商标签: ${c.getVendorTag()}`,"success")}catch(e){u(`获取供应商标签失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testSetTag=function(){if(!c)return void u("请先加载 FLAC 文件","warning");const e=document.getElementById("tagInput");if(e&&e.value)try{c.setTag(e.value),u(`设置标签成功: ${e.value}`,"success"),e.value="",g()}catch(t){u(`设置标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请输入标签（格式: NAME=VALUE）","warning")},window.testGetTag=function(){if(!c)return void u("请先加载 FLAC 文件","warning");const e=document.getElementById("tagNameInput");if(e&&e.value)try{const t=c.getTag(e.value);t?u(`标签 ${e.value}: ${t}`,"success"):u(`未找到标签: ${e.value}`,"warning")}catch(t){u(`获取标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请输入标签名称","warning")},window.testRemoveTag=function(){if(!c)return void u("请先加载 FLAC 文件","warning");const e=document.getElementById("tagNameInput");if(e&&e.value)try{c.removeTag(e.value),u(`删除标签成功: ${e.value}`,"success"),g()}catch(t){u(`删除标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请输入标签名称","warning")},window.testRemoveFirstTag=function(){if(!c)return void u("请先加载 FLAC 文件","warning");const e=document.getElementById("tagNameInput");if(e&&e.value)try{c.removeFirstTag(e.value),u(`删除第一个标签成功: ${e.value}`,"success"),g()}catch(t){u(`删除标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请输入标签名称","warning")},window.testRemoveAllTags=function(){if(c)try{c.removeAllTags(),u("删除所有标签成功","success"),g()}catch(e){u(`删除所有标签失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testImportTags=function(){if(!c)return void u("请先加载 FLAC 文件","warning");const e=document.getElementById("tagsTextarea");if(e&&e.value)try{c.importTagsFromString(e.value),u("导入标签成功","success"),g()}catch(t){u(`导入标签失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请输入标签（每行一个，格式: NAME=VALUE）","warning")},window.testGetAllTags=function(){if(c)try{u(`所有标签: ${c.getAllTags().join(", ")}`,"success"),g()}catch(e){u(`获取所有标签失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testExportTags=function(){if(c)try{const e=c.exportTagsToString();u(`导出标签:\n${e}`,"success");const t=document.getElementById("tagsTextarea");t&&(t.value=e)}catch(e){u(`导出标签失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testGetPicturesSpecs=function(){if(c)try{const e=c.getPicturesSpecs();u(`图片规格: ${JSON.stringify(e,null,2)}`,"success"),d()}catch(e){u(`获取图片规格失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testExportPicture=function(e=0){if(c)try{const t=c.exportPictureToBlob(e),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=`picture-${e}.${t.type.includes("jpeg")?"jpg":"png"}`,n.click(),URL.revokeObjectURL(r),u(`导出图片成功: picture-${e}`,"success")}catch(t){u(`导出图片失败: ${t instanceof Error?t.message:String(t)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testSaveAsBlob=function(){if(c)try{u(`保存为 Blob 成功: ${c.saveAsBlob().size} bytes`,"success")}catch(e){u(`保存为 Blob 失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testSaveAsArrayBuffer=function(){if(c)try{u(`保存为 ArrayBuffer 成功: ${c.save().byteLength} bytes`,"success")}catch(e){u(`保存为 ArrayBuffer 失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testSaveAsBuffer=function(){if(c)try{u(`保存为 Buffer 成功: ${c.saveAsBuffer().length} bytes`,"success")}catch(e){u(`保存为 Buffer 失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")},window.testDownload=function(){if(c&&l)try{const e=c.saveAsBlob(),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=l.name.replace(".flac","_modified.flac"),r.click(),URL.revokeObjectURL(t),u("下载文件成功","success")}catch(e){u(`下载文件失败: ${e instanceof Error?e.message:String(e)}`,"error")}else u("请先加载 FLAC 文件","warning")};
//# sourceMappingURL=main.oYH5V03m.js.map
